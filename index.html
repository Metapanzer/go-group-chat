<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WebSocket Chat</title>
    <style>
      #chat {
        height: 300px;
        overflow-y: scroll;
      }
    </style>
  </head>
  <body>
    <div id="chat"></div>
    <form id="form" onsubmit="sendMessage(); return false;">
      <input
        type="text"
        id="messageInput"
        placeholder="Type your message..."
        required
      />
      <button type="submit">Send</button>
    </form>

    <script>
      const socket = new WebSocket("ws://localhost:8080/ws");
      const chatDiv = document.getElementById("chat");
      const form = document.getElementById("form");
      const messageInput = document.getElementById("messageInput");

      socket.onmessage = function (event) {
        const data = JSON.parse(event.data);
        appendMessage(data.username, data.message);
      };

      form.addEventListener("submit", function () {
        sendMessage();
      });

      function sendMessage() {
        const message = messageInput.value;
        if (message.trim() !== "") {
          socket.send(JSON.stringify({ message: message }));
          messageInput.value = "";
        }
      }

      function appendMessage(username, message) {
        const p = document.createElement("p");
        p.textContent = `${username}: ${message}`;
        chatDiv.appendChild(p);
      }
    </script>
  </body>
</html>
